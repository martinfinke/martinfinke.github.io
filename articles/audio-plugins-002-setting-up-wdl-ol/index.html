<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <meta name=HandheldFriendly content=True> <meta name=MobileOptimized content=320> <meta name=viewport content="width=device-width"> <meta http-equiv=cleartype content=on> <meta property="fb:admins" content=100001493355877> <meta property="og:image" content="http://www.martin-finke.de/blog/img/making_audio_plugins_thumbnail.png"> <meta property="og:image:type" content="image/png"> <meta property="og:image:width" content=100> <meta property="og:image:height" content=100> <title>Making Audio Plugins Part 2: Setting up WDL-OL - Martin Finke's Blog </title> <link rel=alternate href="/blog/feed.xml" type="application/rss+xml" title="Music &amp; Programming"> <link href="http://fonts.googleapis.com/css?family=Domine:700|Inconsolata:400,700" rel=stylesheet type="text/css"> <link rel=stylesheet href='/blog/css/4407aa6.css'> </head> <body class=article-detail> <header class=header> <div class=content-wrap> <h1>Making Audio Plugins Part 2: Setting up WDL-OL</h1> <div class=taglinks><a href="/blog/tags/making_audio_plugins.html" class=taglink>Making Audio Plugins</a> </div> </div> </header> <div id=content> <div class=content-wrap> <article class=article> <section class=content><p>In this post we’ll install the <span class=caps>WDL</span>-<span class=caps>OL</span> library and its dependencies. We will then run one of the demo projects to make sure everything’s working&nbsp;fine.</p> <p><span class=more></span></p> <p>Most of this is also covered in the videos by Oli&nbsp;Larkin:</p> <div class=youtube-video><iframe width="100%" height="100%" src="//www.youtube.com/embed/POP_z0dAn9c?rel=0" frameborder=0 allowfullscreen></iframe></div> <div class=youtube-video><iframe width="100%" height="100%" src="//www.youtube.com/embed/uWitp7EOWVA?rel=0" frameborder=0 allowfullscreen></iframe><br/></div> <p>The following section is Mac-specific. The guide for Windows is <a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/#windows_setup">below</a>.</p> <h2 id=setup-on-mac-os-x-using-xcode-4>Setup on Mac <span class=caps>OS</span> X using Xcode&nbsp;4</h2> <p>Before we can get started, we have to download and install a few things. This part is a little laborious, but you only have to do it&nbsp;once.</p> <p><a name=prerequisites></a></p> <h3 id=prerequisites>Prerequisites</h3> <ol> <li>If you don’t have Xcode installed, <a href="https://developer.apple.com/xcode/">download</a> and install&nbsp;it.</li> <li>Download the <a href="http://www.steinberg.net/en/company/developer.html"><span class=caps>VST3</span> <span class=caps>SDK</span></a>. You will have to register for an account&nbsp;first.</li> <li>Download the <em>Audio Tools for Xcode</em>. In Xcode’s application menu, click <em>Open Developer Tool</em> → <em>More Developer Tools…</em> (or click <a href="https://developer.apple.com/downloads/index.action?name=for%20Xcode%20-">here</a>). Find <em>Audio Tools for Xcode</em> in the list, download and install it. There’s a different version for different <span class=caps>OS</span> X versions, make sure you get the right&nbsp;one.</li> <li>Download <a href="http://www.music.mcgill.ca/~gary/rtaudio/">RtAudio</a> (includes the <span class=caps>ASIO</span> <span class=caps>SDK</span> files we&nbsp;need).</li> <li>If you don’t have <em>git</em>, make sure you <a href="http://git-scm.com/downloads">install it</a> first. It’s worth&nbsp;it!</li> </ol> <h3 id=downloading-wdl-ol>Downloading&nbsp;<span class=caps>WDL</span>-<span class=caps>OL</span></h3> <p>Now open a <a href="http://smokingapples.com/software/tutorials/mac-terminal-tips/">Terminal</a>. Type the following lines to create a new folder inside your home directory and go into&nbsp;it:</p> <pre><code>mkdir ~/plugin-development
cd !$
</code></pre><p>Let’s get&nbsp;<span class=caps>WDL</span>-<span class=caps>OL</span>:</p> <pre><code>git clone https://github.com/olilarkin/wdl-ol
cd wdl-ol
</code></pre><p>You may want to copy <span class=amp>&amp;</span> paste the last line. Don’t forget the dot at the end! It ensures that you’re using the same version of <span class=caps>WDL</span>‑<span class=caps>OL</span> that’s used for these tutorials. You should have a new subfolder called <em>wdl-ol</em>.<br><a name=copy_sdk_files></a></p> <h3 id=adding-the-dependencies>Adding the&nbsp;Dependencies</h3> <p>Go into <em>ASIO_SDK</em> and copy the .cpp/.h files from RtAudio’s <em>include</em> folder here. Unzip the <span class=caps>VST3</span> <span class=caps>SDK</span>, and copy the files <em>aeffect.h</em> and <em>aeffectx.h</em> from the folder <em>pluginterfaces</em> → <em>vst2.x</em> into <span class=caps>WDL</span>-<span class=caps>OL</span>’s <em>VST_SDK</em> subfolder. Apart from that, You only need the <em>base/source</em>, <em>pluginterfaces</em> and <em>public.sdk/source</em> folders for <span class=caps>VST3</span>. Copy them like&nbsp;this:</p> <p><a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/vst3copy.png"><img src="/blog/articles/audio-plugins-002-setting-up-wdl-ol/vst3copy.png" alt="How to copy VST3 SDK files"></a></p> <p>Note that you’ll have to create the <em>public.sdk</em> folder by hand. This is what your folder structure should look&nbsp;like:</p> <p><a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/folderstructure.png"><img src="folderstructure.png" alt="Folder structure for WDL-OL" style="width: auto; margin-left: auto; margin-right: auto;"/></a></p> <p>Now open <em>common.xcconfig</em> (it should open in Xcode) and make the following&nbsp;changes:</p> <p><a name=deployment_target></a></p> <pre><code class="lang-objectivec">CERTIFICATE_ID = Your Name

<span class="comment">// Comment this line out:</span>
<span class="comment">// <span class="caps">COMPILER</span> = com.apple.compilers.gcc.4_2</span>
<span class="comment">// Uncomment this line:</span>
<span class="caps">COMPILER</span> = com<span class="variable">.apple</span><span class="variable">.compilers</span><span class="variable">.llvm</span><span class="variable">.clang</span><span class="number">.1</span>_0

<span class="comment">// Add these lines:</span>
VST_FOLDER = ~/Library/Audio/Plug-Ins/<span class="caps">VST</span>
VST3_FOLDER = ~/Library/Audio/Plug-Ins/<span class="caps">VST3</span>
AU_FOLDER = ~/Library/Audio/Plug-Ins/Components
<span class="comment">// Comment these out:</span>
<span class="comment">//VST_FOLDER = /Library/Audio/Plug-Ins/<span class="caps">VST</span></span>
<span class="comment">//VST3_FOLDER = /Library/Audio/Plug-Ins/<span class="caps">VST3</span></span>
<span class="comment">//AU_FOLDER = /Library/Audio/Plug-Ins/Components</span>
</code></pre> <p>You can also see that we’re going to use Mac <span class=caps>OS</span> X 10.5 as both <code>BASE_SDK</code> and <code>MACOSX_DEPLOYMENT_TARGET</code>. Music producers and especially recording studios are often <em>very</em> lazy about updating their operating system: They don’t need any new features, but having the studio disfunctional for a few days due to updating problems could cause big losses.<br>Actually, the <em>deployment target</em> is the version your users will need, but I prefer to set the base <span class=caps>SDK</span> to the same version as well.<br>The 10.5 <span class=caps>SDK</span> isn’t included with Xcode 4. If you already have it installed, skip to <a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/#duplicating_example_project">Running the Example Project</a>. If you don’t have it, read&nbsp;on:</p> <h3 id=installing-the-10-5-sdk>Installing the 10.5&nbsp;<span class=caps>SDK</span></h3> <p>To get the 10.5 <span class=caps>SDK</span>, you need to <a href="https://developer.apple.com/downloads/index.action?searchTextField=3.2.6">download Xcode 3.2.6</a>. Once you have it downloaded, mount the <em>.dmg</em> file, open Terminal.app and&nbsp;enter:</p> <pre><code>open /Volumes/Xcode\ and\ iOS\ SDK/Packages/
</code></pre><p>A Finder window will open and there will be a file called <em>MacOSX10.5.pkg</em>. Double-click it. If you’re using <span class=caps>OS</span> X 10.8 or later, it’ll show a message saying that it can’t install software from an unidentified developer. In that case, right-click the file, choose <em>Open</em> in the menu, and confirm that you really want to install the software. When installing, choose <em>change install location</em> and option-click on the drive you want to install to, so that you can specify a folder. Install it to the <em>Downloads</em> folder inside your user folder, for example.<br>After that’s done, you’ll have a new folder called <em>MacOSX10.5.sdk</em> in the location you selected. In Terminal.app,&nbsp;type:</p> <pre><code>open /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs
</code></pre><p>Again, a Finder window will open. Drag the <em>MacOSX10.5.sdk</em> folder in there. After restarting Xcode, you should now have the old <span class=caps>SDK</span> available in Xcode 4. Make sure you keep the <em>MacOSX10.5.pkg</em> around somewhere: If you update Xcode to a newer version, you’ll probably have to do this step again.<br>If you have any problems installing the 10.5 <span class=caps>SDK</span>, please leave a comment and I’ll be happy to&nbsp;help.</p> <p><a name=duplicating_example_project></a></p> <h3 id=running-the-example-project>Running the Example&nbsp;Project</h3> <p>Back in your terminal, go to the examples&nbsp;folder:</p> <pre><code>cd IPlugExamples
</code></pre><p><a name=duplicate_script></a> Run the <em>duplicate</em> script to create your first plugin (replace YourName with your&nbsp;name):</p> <pre><code>./duplicate.py IPlugEffect/ MyFirstPlugin YourName
</code></pre><p>You will notice that there’s a new folder <em>MyFirstPlugin</em>. Go into it and open <em>MyFirstPlugin.xcodeproj</em>. Select the <em><span class=caps>APP</span></em> Target:</p> <p><a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/target.png"><img src="/blog/articles/audio-plugins-002-setting-up-wdl-ol/target.png" alt="Selecting the APP Target"></a></p> <p><a name=standalone_no_sound_fix></a> Now there’s a small bug in <span class=caps>WDL</span>-<span class=caps>OL</span> where the standalone app doesn’t output any sound unless you choose a different audio input. Fortunately that’s easy to fix: In Xcode’s project navigator, open <em>Other Sources</em> → <em><span class=caps>OSX</span> App Wrapper</em> → <em>app_main.h</em>. Change line 34 (the one with <code>#define DEFAULT_INPUT_DEV</code>) to&nbsp;this:</p> <pre><code class="lang-cpp"><span class="preprocessor">#define DEFAULT_INPUT_DEV "Built-in Microphone"</span>
</code></pre> <p>Click <em>Run</em>. You will get a few linker&nbsp;errors:</p> <p><a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/linker-error.png"><img src="/blog/articles/audio-plugins-002-setting-up-wdl-ol/linker-error.png" alt="Linker errors"></a></p> <p>These are easy to fix. Go to your project’s build setting (make sure you select your project, not a specific target) and set the value for <em>Implicitly Link Objective-C Runtime Support</em> to <em>No</em>:</p> <p><a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/implicitly-link.png"><img src="/blog/articles/audio-plugins-002-setting-up-wdl-ol/implicitly-link.png" alt=""></a></p> <p><a name=run_first_plugin></a> Click <em>Run</em> again. After a few seconds, you should see your first plugin run as a standalone&nbsp;app:</p> <p><a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/first-plugin.jpg"><img src="/blog/articles/audio-plugins-002-setting-up-wdl-ol/first-plugin.jpg" alt="Screenshot of first plugin running"></a></p> <h3 id=validating-the-audiounit-version-without-logic>Validating the AudioUnit version without&nbsp;Logic</h3> <p>If you don’t own Logic, you can use Apple’s free <code>auval</code> tool to check whether your plugin’s <span class=caps>AU</span> version is working correctly. Make sure you’ve successfully built the <em><span class=caps>AU</span></em> target, open a Terminal and&nbsp;enter:</p> <pre><code class="lang-bash">auval <span class="operator">-a</span> <span class="number">2</span>&gt; /dev/null | grep MyFirstPlugin
</code></pre> <p>It should output a line similar to this&nbsp;one:</p> <pre><code class="lang-bash">aumu Abcd Efgh  -  YourName: MyFirstPlugin
</code></pre> <p>If it doesn’t give any output, try <a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/#logic_doesnt_find_au">this</a>.</p> <p><a name=logic_doesnt_find_au></a></p> <h3 id=troubleshooting>Troubleshooting</h3> <p>If <strong>Logic (or <code>auval</code>) doesn’t find the <span class=caps>AU</span> version</strong> (and other hosts like <span class=caps>REAPER</span> see it): Go into the Build Settings, and make sure that the <em><span class=caps>AU</span></em> target is selected in the upper left. Search for “active arch”, and the list should only show one entry: <em>Build Active Architecture Only</em>, which has the value: <em>&lt;Multiple&nbsp;Values&gt;</em>. Change that to <em>No</em>. This way, 32- and 64-Bit will be compiled even in Debug mode. After that, run <em>Product</em> → <em>Clean</em> (Cmd+Shift+K), build again and it should&nbsp;work.</p> <p><a name=windows_setup></a></p> <h2 id=setup-on-windows-using-visual-c-2010-express>Setup on Windows using Visual C++ 2010&nbsp;Express</h2> <p>First, install <a href="http://www.microsoft.com/visualstudio/eng/downloads#d-2010-express">Visual C++ 2010 Express</a>. Visual Studio 2012 has been reported to work, but I can’t test it on my system. After that, install <a href="http://git-scm.com/download/win">Git for Windows</a>, using the default settings. I used version 1.8.4. Run <em>Start</em> → <em>Program Files</em> → <em>Git</em> → <em>Git Bash</em>. A terminal window will open. In that window, run the following&nbsp;commands:</p> <pre><code>cd c:
git clone https://github.com/olilarkin/wdl-ol
cd wdl-ol
</code></pre><p>To paste into the window, right-click the title bar and chosse <em>Edit</em> → <em>Paste</em>:</p> <p><a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/mingw_paste.png"><img src="/blog/articles/audio-plugins-002-setting-up-wdl-ol/mingw_paste.png" alt=""></a></p> <p>Now copy all the <span class=caps>VST2</span>/<span class=caps>VST3</span>/<span class=caps>ASIO</span> <span class=caps>SDK</span> files into the right folders, as <a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/#copy_sdk_files">described above</a>. Install <a href="http://www.python.org/getit/">Python</a> using the default settings. I used version&nbsp;2.7.5.</p> <p>To be able to build <span class=caps>VST3</span> plugins, we have to create the <span class=caps>VST3</span> folder. Run this command in the&nbsp;terminal:</p> <pre><code class="lang-bash">mkdir -p <span class="string">"C:\Program Files\Common Files\<span class="caps">VST3</span>"</span>
</code></pre> <p>Now (in the terminal), navigate to the <em>IPlugExamples</em> subfolder:</p> <pre><code>cd IPlugExamples/
</code></pre><p>Run the <em>duplicate</em> script using the Python you just&nbsp;installed:</p> <pre><code>/c/Python27/python.exe duplicate.py IPlugEffect MyFirstPlugin YourName
</code></pre><p>You’ll get a new folder <em>MyFirstPlugin</em>. Go into it and open <em>MyFirstPlugin.sln</em>. Ignore the warning, it just means that you can’t compile <span class=caps>AAX</span> and <span class=caps>TDM</span> formats. In the project explorer on the left, make sure <em>MyFirstPlugin-app</em> is shown&nbsp;bold:</p> <p><a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/project_explorer.png"><img src="/blog/articles/audio-plugins-002-setting-up-wdl-ol/project_explorer.png" alt=""></a></p> <p>If it isn’t, right-click it and choose <em>Set as StartUp Project</em>. Now press the <em>F5</em> key, and you should see a window like&nbsp;this:</p> <p><a href="/blog/articles/audio-plugins-002-setting-up-wdl-ol/run_app.png"><img src="/blog/articles/audio-plugins-002-setting-up-wdl-ol/run_app.png" alt=""></a></p> <p>Lovely,&nbsp;right?</p> <h3 id=troubleshooting>Troubleshooting</h3> <p><a name=error_lnk1123></a> If you get a <strong>fatal error <span class=caps>LNK1123</span></strong> when building, you may have to disable <em>incremental linking</em>: Right-click the <em>MyFirstPlugin-app</em> project, click <em>Properties</em> and go to <em>Configuration Properties</em> → <em>Linker (General)</em> → <em>Enable Incremental Linking</em> → <em>“No (/<span class=caps>INCREMENTAL</span>:<span class=caps>NO</span>)”</em>.<br>If that doesn’t solve it, try installing <a href="http://www.microsoft.com/en-us/download/details.aspx?id=23691">Visual Studio 2010 <span class=caps>SP1</span></a>. You may also want the <a href="http://www.microsoft.com/en-us/download/details.aspx?id=4422">Compiler Update</a> to get 64-Bit&nbsp;support.</p> <p>If you get warnings that <strong>CreatePackage.bat […] exited with code 1</strong>, don’t worry about it (unless you want to build an <span class=caps>AAX</span> plugin). The warning just means that the <span class=caps>AAX</span> <span class=caps>SDK</span> isn’t&nbsp;there.</p> <p>The warning <strong>Cannot open include file: ‘ForcedInclude.h’: No such file or directory</strong> means that the <span class=caps>RTAS</span> <span class=caps>SDK</span> wasn’t found. If you’re not trying to build <span class=caps>RTAS</span>, you can ignore&nbsp;this.</p> <p>If you have any other problems, feel free to leave a comment! <a href="/blog/articles/audio-plugins-003-examining-the-code/">Next time</a> we’ll examine the&nbsp;code.</p> </section> </article> <div id=donation_prompt>If you found this useful, please feel free to <form action="https://www.paypal.com/cgi-bin/webscr" method=post target=_top class=donation-form> <input type=hidden name=cmd value=_s-xclick> <input type=hidden name=hosted_button_id value=JQDU8W5PJBWL6> <input type=hidden name=ref value="/blog/articles/audio-plugins-002-setting-up-wdl-ol/"> <input type=image src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border=0 name=submit alt="PayPal - The safer, easier way to pay online!"><img alt="" border=0 src="https://www.paypalobjects.com/de_DE/i/scr/pixel.gif" width=1 height=1> </form>! </div> <iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.martin-finke.de%2Fblog%2F&amp;width=450&amp;height=21&amp;colorscheme=light&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;send=false" scrolling=no frameborder=0 style="border: none; overflow: hidden; width: 200px; height: 21px;" allowtransparency=true></iframe> <div class=comments> <div id=disqus_thread></div> <script type="text/javascript">var disqus_shortname="martinfinke";(function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)})();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <a href="http://disqus.com" class=dsq-brlink>comments powered by <span class=logo-disqus>| Disqus</span></a> </div> </div> </div> <footer> <div class=content-wrap> <div class=nav><a href="/blog/">« Index</a></div> <section class=copy> <p>&copy; 2015 Martin Finke – <a href="/blog/impressum.html" class=impressum-link>Impressum</a></p> </section> </div> </footer> <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script> <script>window.jQuery||document.write('<script src="/blog/js/vendor/jquery-1.10.2.min.js"><\/script>');</script> <script type="text/javascript">$(document).ready(function(){$('a:link[href^=http]:not([href*="martin-finke.de"])').attr("target","_blank")});</script> <script type="text/javascript">var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-43375106-1"]);_gaq.push(["_trackPageview"]);(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src=("https:"==document.location.protocol?"https://":"http://")+"stats.g.doubleclick.net/dc.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)})();</script> </body> </html>